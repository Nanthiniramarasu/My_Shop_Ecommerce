{% extends 'store/base.html' %}

{% block content %}

  <div style="width: 100%; margin: 30px auto; padding: 20px;">
    <!-- Search & Filter Form -->
    <form method="get" style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 30px;">
      <input
        type="text"
        name="q"
        placeholder="Search products..."
        value="{{ request.GET.q }}"
        style="flex: 2; padding: 10px; border: 1px solid #ccc; border-radius: 6px;"
      />
      <select
        name="category"
        style="flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 6px;"
      >
        <option value="">All Categories</option>
        {% for cat in categories %}
          <option value="{{ cat }}" {% if request.GET.category == cat %}selected{% endif %}>{{ cat }}</option>
        {% endfor %}
      </select>
      <button
        type="submit"
        class="btn"
        style="padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 6px;"
      >
        Search
      </button>
    </form>

    <!-- Product List -->
    <div style="
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
    ">
      {% for product in products %}
        <div style="
          background: #fff;
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          padding: 15px;
          text-align: center;
        ">
        
          {% if product.image %}
            <img src="{{ product.image.url }}" alt="{{ product.name }}" width="150" style="margin-bottom: 10px;" />
          {% comment %} {% else %}
            <img src="{% static 'images/default.jpg' %}" alt="No Image" width="150" style="margin-bottom: 10px;" /> {% endcomment %}
          {% endif %}
          <h3 style="margin: 10px 0;">{{ product.name }}</h3>
          <p style="font-size: 1rem; margin: 5px 0;">â‚¹{{ product.price }}</p>
          <p style="color: #555;">Category: {{ product.category }}</p>
          <a href="{% url 'store:product_detail' product.id %}" class="btn" style="margin-top: 10px;">View Details</a>
        </div>
      {% empty %}
        <p style="grid-column: 1 / -1;">No products found.</p>
      {% endfor %}
    </div>
  </div>
{% endblock %}
